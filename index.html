<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèÑ‚Äç‚ôÇÔ∏è SurfAI - App Intelligente (Backend)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .nav-tabs {
            display: flex;
            background: white;
            border-radius: 12px;
            padding: 8px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        
        .nav-tab {
            flex: 1;
            background: none;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            white-space: nowrap;
            min-width: 120px;
        }
        
        .nav-tab.active {
            background: #667eea;
            color: white;
        }
        
        .nav-tab:hover:not(.active) {
            background: #f0f0f0;
        }
        
        .tab-content {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            min-height: 500px;
        }
        
        .tab-panel {
            display: none;
        }
        
        .tab-panel.active {
            display: block;
        }
        
        .card {
            background: #f8fafc;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }
        
        .card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        .button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
        }
        
        .button:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }
        
        .button.secondary {
            background: #e2e8f0;
            color: #4a5568;
        }
        
        .button.secondary:hover {
            background: #cbd5e0;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }
        
        .forecast-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .forecast-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .forecast-card.excellent {
            border-color: #48bb78;
            background: linear-gradient(45deg, #f0fff4, #ffffff);
        }
        
        .forecast-card.good {
            border-color: #4299e1;
            background: linear-gradient(45deg, #ebf8ff, #ffffff);
        }
        
        .forecast-card.average {
            border-color: #ed8936;
            background: linear-gradient(45deg, #fffaf0, #ffffff);
        }
        
        .forecast-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .forecast-date {
            font-weight: bold;
            color: #667eea;
        }
        
        .forecast-score {
            background: #48bb78;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .forecast-score.excellent {
            background: #48bb78;
        }
        
        .forecast-score.good {
            background: #4299e1;
        }
        
        .forecast-score.average {
            background: #ed8936;
        }
        
        .forecast-score.poor {
            background: #f56565;
        }
        
        .forecast-conditions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        
        .condition {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .prediction-info {
            background: #f7fafc;
            border-radius: 6px;
            padding: 8px;
            margin-top: 8px;
            font-size: 0.85rem;
        }
        
        .prediction-recommendation {
            font-weight: 600;
            color: #4a5568;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .error {
            background: #fed7d7;
            color: #c53030;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .success {
            background: #c6f6d5;
            color: #25543e;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .backend-status {
            background: #e6fffa;
            border: 1px solid #81e6d9;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 20px;
        }
        
        .backend-status.connected {
            background: #f0fff4;
            border-color: #68d391;
        }
        
        .backend-status.error {
            background: #fed7d7;
            border-color: #fc8181;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
            }
            
            .nav-tab {
                min-width: auto;
                flex: 1;
            }
            
            .forecast-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üèÑ‚Äç‚ôÇÔ∏è SurfAI</h1>
            <p>Version Backend S√©curis√©e - Intelligence de surf avanc√©e</p>
        </div>
        
        <!-- Backend Status -->
        <div id="backend-status" class="backend-status">
            <div style="display: flex; align-items: center; gap: 10px;">
                <span id="backend-indicator">üîµ</span>
                <span id="backend-message">V√©rification connexion backend...</span>
            </div>
        </div>
        
        <!-- Navigation -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('dashboard')">üìä Dashboard</button>
            <button class="nav-tab" onclick="showTab('sessions')">üèÑ‚Äç‚ôÇÔ∏è Sessions</button>
            <button class="nav-tab" onclick="showTab('spots')">üìç Spots</button>
            <button class="nav-tab" onclick="showTab('profile')">üë§ Profile</button>
            <button class="nav-tab" onclick="showTab('predictions')">üéØ Pr√©dictions</button>
            <button class="nav-tab" onclick="showTab('meteo')">üåä M√©t√©o</button>
            <button class="nav-tab" onclick="showTab('config')">‚öôÔ∏è Configuration</button>
        </div>
        
        <!-- Content -->
        <div class="tab-content">
            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-panel active">
                <h2>üìä Tableau de bord</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="total-sessions">-</div>
                        <div class="stat-label">Sessions totales</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="avg-rating">-</div>
                        <div class="stat-label">Note moyenne</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="favorite-spots">-</div>
                        <div class="stat-label">Spots favoris</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="backend-status-indicator">üî¥</div>
                        <div class="stat-label">Backend SurfAI</div>
                    </div>
                </div>
                
                <div class="card">
                    <h3>üéØ Prochaines sessions recommand√©es (IA)</h3>
                    <div id="recommendations">
                        <div class="loading">Chargement des recommandations intelligentes...</div>
                    </div>
                </div>
                
                <div class="card">
                    <h3>üìà Vos patterns de surf</h3>
                    <div id="patterns">
                        <p>Analysez vos sessions pour d√©couvrir vos conditions pr√©f√©r√©es !</p>
                        <button class="button" onclick="analyzePatterns()">Analyser mes patterns</button>
                    </div>
                </div>
            </div>
            
            <!-- Sessions Tab -->
            <div id="sessions" class="tab-panel">
                <h2>üèÑ‚Äç‚ôÇÔ∏è Mes Sessions</h2>
                
                <div class="card">
                    <h3>‚ûï Ajouter une nouvelle session</h3>
                    <form id="session-form">
                        <div class="form-group">
                            <label>Date de la session</label>
                            <input type="date" id="session-date" required>
                        </div>
                        <div class="form-group">
                            <label>Spot</label>
                            <select id="session-spot" required>
                                <option value="">S√©lectionnez un spot</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Note de la session (1-5)</label>
                            <select id="session-rating" required>
                                <option value="">Choisir une note</option>
                                <option value="1">1 ‚≠ê - D√©cevant</option>
                                <option value="2">2 ‚≠ê - Correct</option>
                                <option value="3">3 ‚≠ê - Bien</option>
                                <option value="4">4 ‚≠ê - Tr√®s bien</option>
                                <option value="5">5 ‚≠ê - Excellent</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Commentaires</label>
                            <textarea id="session-notes" rows="3" placeholder="D√©crivez votre session..."></textarea>
                        </div>
                        <button type="submit" class="button">üíæ Enregistrer la session</button>
                    </form>
                </div>
                
                <div class="card">
                    <h3>üìã Historique des sessions</h3>
                    <div id="sessions-list">
                        <div class="loading">Chargement des sessions...</div>
                    </div>
                </div>
            </div>
            
            <!-- Spots Tab -->
            <div id="spots" class="tab-panel">
                <h2>üìç Mes Spots</h2>
                
                <div class="card">
                    <h3>‚≠ê Spots favoris</h3>
                    <div id="favorite-spots-list">
                        <div class="loading">Chargement des spots favoris...</div>
                    </div>
                </div>
                
                <div class="card">
                    <h3>üåä Tous les spots disponibles</h3>
                    <div id="all-spots-list">
                        <div class="loading">Chargement des spots...</div>
                    </div>
                </div>
            </div>
            
            <!-- Profile Tab -->
            <div id="profile" class="tab-panel">
                <h2>üë§ Mon Profile</h2>
                
                <!-- Informations personnelles -->
                <div class="card">
                    <h3>üèÑ‚Äç‚ôÇÔ∏è Informations de surfeur</h3>
                    <form id="profile-form">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div class="form-group">
                                <label>Pseudo</label>
                                <input type="text" id="profile-nickname" placeholder="Votre pseudo">
                            </div>
                            <div class="form-group">
                                <label>Niveau de surf</label>
                                <select id="profile-level">
                                    <option value="beginner">üå± D√©butant</option>
                                    <option value="intermediate" selected>üèÑ‚Äç‚ôÇÔ∏è Interm√©diaire</option>
                                    <option value="advanced">üåä Avanc√©</option>
                                    <option value="expert">üèÜ Expert</option>
                                </select>
                            </div>
                        </div>
                        
                        <h4 style="margin: 20px 0 10px 0;">üåä Pr√©f√©rences de vagues</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                            <div class="form-group">
                                <label>Taille min (m√®tres)</label>
                                <input type="number" id="profile-wave-min" step="0.1" min="0.3" max="5" placeholder="0.8">
                            </div>
                            <div class="form-group">
                                <label>Taille max (m√®tres)</label>
                                <input type="number" id="profile-wave-max" step="0.1" min="0.5" max="8" placeholder="2.5">
                            </div>
                        </div>
                        
                        <button type="submit" class="button">üíæ Sauvegarder le profil</button>
                    </form>
                </div>
                
                <!-- Mes Boards -->
                <div class="card">
                    <h3>üèÑ‚Äç‚ôÇÔ∏è Mes Boards</h3>
                    
                    <!-- Formulaire ajout board -->
                    <div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <h4>‚ûï Ajouter une board</h4>
                        <form id="board-form">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                <div class="form-group">
                                    <label>Nom de la board</label>
                                    <input type="text" id="board-name" placeholder="Ex: Ma Longboard" required>
                                </div>
                                <div class="form-group">
                                    <label>Taille (pieds)</label>
                                    <input type="text" id="board-size" placeholder="Ex: 9'2" required>
                                </div>
                                <div class="form-group">
                                    <label>Type</label>
                                    <select id="board-type" required>
                                        <option value="">Choisir un type</option>
                                        <option value="longboard">üèÑ‚Äç‚ôÇÔ∏è Longboard</option>
                                        <option value="midlength">üèÑ‚Äç‚ôÄÔ∏è Midlength</option>
                                        <option value="shortboard">‚ö° Shortboard</option>
                                        <option value="fish">üê† Fish</option>
                                        <option value="gun">üöÄ Gun</option>
                                        <option value="funboard">üòä Funboard</option>
                                        <option value="sup">üèÑ‚Äç‚ôÇÔ∏è SUP</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Shaper</label>
                                    <input type="text" id="board-shaper" placeholder="Ex: Robert August" required>
                                </div>
                            </div>
                            <button type="submit" class="button">‚ûï Ajouter cette board</button>
                        </form>
                    </div>
                    
                    <!-- Liste des boards -->
                    <div id="user-boards-list">
                        <div class="loading">Chargement de vos boards...</div>
                    </div>
                </div>
                
                <!-- Mes Spots Favoris -->
                <div class="card">
                    <h3>‚≠ê Mes Spots Favoris</h3>
                    <div id="profile-favorite-spots">
                        <div class="loading">Chargement de vos spots favoris...</div>
                    </div>
                </div>
                
                <!-- Shapers & Recommandations -->
                <div class="card">
                    <h3>üî® Shapers & Recommandations</h3>
                    <div id="shapers-directory">
                        <p>D√©couvrez les shapers de vos boards et trouvez votre prochaine planche !</p>
                        <div id="shapers-list">
                            <div class="loading">Chargement des shapers...</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Predictions Tab -->
            <div id="predictions" class="tab-panel">
                <h2>üéØ Pr√©dictions Intelligentes</h2>
                
                <div class="card">
                    <h3>üèÜ Recommandations pour les prochains jours</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                        <div class="form-group">
                            <label>Votre niveau</label>
                            <select id="prediction-level">
                                <option value="beginner">üå± D√©butant</option>
                                <option value="intermediate" selected>üèÑ‚Äç‚ôÇÔ∏è Interm√©diaire</option>
                                <option value="advanced">üåä Avanc√©</option>
                                <option value="expert">üèÜ Expert</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Nombre de jours</label>
                            <select id="prediction-days">
                                <option value="1">1 jour</option>
                                <option value="2" selected>2 jours</option>
                                <option value="3">3 jours</option>
                                <option value="5">5 jours</option>
                            </select>
                        </div>
                    </div>
                    <button class="button" onclick="generateIntelligentPredictions()">üîÆ G√©n√©rer pr√©dictions IA</button>
                    <div id="predictions-list">
                        <p>Cliquez sur "G√©n√©rer pr√©dictions IA" pour voir les meilleures sessions √† venir !</p>
                    </div>
                </div>
                
                <div class="card">
                    <h3>üìä Pr√©cision de mes pr√©dictions pass√©es</h3>
                    <div id="accuracy-stats">
                        <p>Vos pr√©dictions s'am√©liorent au fur et √† mesure de vos sessions !</p>
                    </div>
                </div>
            </div>
            
            <!-- Meteo Tab -->
            <div id="meteo" class="tab-panel">
                <h2>üåä M√©t√©o Marine</h2>
                
                <div class="card">
                    <h3>üß™ Test Backend SurfAI</h3>
                    <p>Testez votre connexion au backend s√©curis√©</p>
                    <button class="button" onclick="testBackendConnection()">üîç Tester le Backend</button>
                    <div id="backend-test-result"></div>
                </div>
                
                <div class="card">
                    <h3>üì° Pr√©visions en temps r√©el</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                        <div class="form-group">
                            <label>Choisir un spot</label>
                            <select id="forecast-spot">
                                <option value="">S√©lectionnez un spot</option>
                                <option value="biarritz">üèÑ‚Äç‚ôÇÔ∏è Biarritz</option>
                                <option value="hossegor">üåä Hossegor</option>
                                <option value="mimizan">üèñÔ∏è Mimizan</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Votre niveau</label>
                            <select id="forecast-level">
                                <option value="beginner">üå± D√©butant</option>
                                <option value="intermediate" selected>üèÑ‚Äç‚ôÇÔ∏è Interm√©diaire</option>
                                <option value="advanced">üåä Avanc√©</option>
                                <option value="expert">üèÜ Expert</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Nombre de jours</label>
                            <select id="forecast-days">
                                <option value="1">1 jour</option>
                                <option value="2" selected>2 jours</option>
                                <option value="3">3 jours</option>
                            </select>
                        </div>
                    </div>
                    <button class="button" onclick="getIntelligentForecast()">üåä R√©cup√©rer pr√©visions IA</button>
                    <div id="forecast-result">
                        <div class="forecast-grid" id="forecast-grid"></div>
                    </div>
                </div>
            </div>
            
            <!-- Config Tab -->
            <div id="config" class="tab-panel">
                <h2>‚öôÔ∏è Configuration</h2>
                
                <div class="card">
                    <h3>üöÄ Configuration Backend SurfAI</h3>
                    <div class="form-group">
                        <label>URL Backend</label>
                        <input type="text" id="backend-url" value="https://surfai-backend-production.up.railway.app" placeholder="https://surfai-backend-production.up.railway.app">
                    </div>
                    <div class="form-group">
                        <label>Cl√© API (optionnelle)</label>
                        <input type="password" id="backend-api-key" placeholder="Cl√© API pour routes prot√©g√©es">
                    </div>
                    <button class="button" onclick="testBackendConnection()">üîç Tester connexion</button>
                </div>
                
                <div class="card">
                    <h3>üìç Configuration Supabase</h3>
                    <div class="form-group">
                        <label>URL Supabase</label>
                        <input type="text" id="supabase-url" placeholder="https://votre-projet.supabase.co">
                    </div>
                    <div class="form-group">
                        <label>Cl√© Anon Supabase</label>
                        <input type="password" id="supabase-key" placeholder="votre-cle-anon">
                    </div>
                    <button class="button" onclick="testSupabaseConnection()">üîç Tester connexion</button>
                </div>
                
                <div class="card">
                    <h3>üìä √âtat de l'application</h3>
                    <div id="app-status">
                        <p>üî¥ Backend: Non test√©</p>
                        <p>üî¥ Supabase: Non configur√©</p>
                        <p>üî¥ Donn√©es: Non charg√©es</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Variables globales
        let supabaseClient = null;
        let backendUrl = 'https://surfai-backend-production.up.railway.app';
        let backendApiKey = null;
        let userData = {
            sessions: [],
            spots: [],
            favoriteSpots: [],
            predictions: [],
            profile: {},
            boards: [],
            shapers: {}
        };
        let currentUserId = '2025-06-09';

        // Configuration initiale
        document.addEventListener('DOMContentLoaded', async function() {
            // D√©finir la date d'aujourd'hui par d√©faut
            document.getElementById('session-date').value = new Date().toISOString().split('T')[0];
            
            // Charger config sauvegard√©e
            const savedBackendUrl = localStorage.getItem('backend_url');
            const savedApiKey = localStorage.getItem('backend_api_key');
            const savedSupabaseUrl = localStorage.getItem('supabase_url');
            const savedSupabaseKey = localStorage.getItem('supabase_key');
            
            if (savedBackendUrl) {
                backendUrl = savedBackendUrl;
                document.getElementById('backend-url').value = savedBackendUrl;
            }
            if (savedApiKey) {
                backendApiKey = savedApiKey;
                document.getElementById('backend-api-key').value = savedApiKey;
            }
            if (savedSupabaseUrl) document.getElementById('supabase-url').value = savedSupabaseUrl;
            if (savedSupabaseKey) document.getElementById('supabase-key').value = savedSupabaseKey;
            
            // Test auto du backend
            await checkBackendConnection();
            
            // Auto-connexion Supabase si config existe
            if (savedSupabaseUrl && savedSupabaseKey) {
                console.log('üìÑ Auto-connexion Supabase...');
                await testSupabaseConnection();
            } else {
                // Charger donn√©es simul√©es en attendant
                loadSessions();
                loadSpots();
                loadProfile();
            }
            
            // Charger recommandations intelligentes par d√©faut
            await generateIntelligentRecommendations();
        });

        // ========================================
        // FONCTIONS BACKEND
        // ========================================

        // V√©rifier connexion backend
        async function checkBackendConnection() {
            try {
                const response = await fetch(`${backendUrl}/health`);
                const data = await response.json();
                
                if (response.ok) {
                    updateBackendStatus(true, 'Backend connect√© et op√©rationnel');
                    document.getElementById('backend-status-indicator').textContent = 'üü¢';
                    return true;
                } else {
                    throw new Error('Backend non disponible');
                }
            } catch (error) {
                updateBackendStatus(false, `Backend non accessible: ${error.message}`);
                document.getElementById('backend-status-indicator').textContent = 'üî¥';
                return false;
            }
        }

        // Mettre √† jour le statut backend
        function updateBackendStatus(connected, message) {
            const statusDiv = document.getElementById('backend-status');
            const indicator = document.getElementById('backend-indicator');
            const messageEl = document.getElementById('backend-message');
            
            if (connected) {
                statusDiv.className = 'backend-status connected';
                indicator.textContent = 'üü¢';
            } else {
                statusDiv.className = 'backend-status error';
                indicator.textContent = 'üî¥';
            }
            
            messageEl.textContent = message;
        }

        // Test connexion backend
        async function testBackendConnection() {
            const url = document.getElementById('backend-url').value;
            const apiKey = document.getElementById('backend-api-key').value;
            const resultDiv = document.getElementById('backend-test-result');
            
            resultDiv.innerHTML = '<div class="loading">üß™ Test en cours...</div>';
            
            try {
                // Sauvegarder la config
                backendUrl = url;
                backendApiKey = apiKey;
                localStorage.setItem('backend_url', url);
                localStorage.setItem('backend_api_key', apiKey);
                
                // Test health check
                const healthResponse = await fetch(`${url}/health`);
                const healthData = await healthResponse.json();
                
                if (!healthResponse.ok) {
                    throw new Error(`Backend non accessible (${healthResponse.status})`);
                }
                
                // Test API m√©t√©o
                const weatherResponse = await fetch(`${url}/api/v1/weather/test-stormglass`);
                const weatherData = await weatherResponse.json();
                
                resultDiv.innerHTML = `
                    <div class="success">
                        ‚úÖ Backend SurfAI connect√© !<br>
                        üè• Health: ${healthData.status}<br>
                        üåä Stormglass: ${weatherData.success ? '‚úÖ Fonctionnel' : '‚ùå Erreur'}<br>
                        üìä Points de donn√©es: ${weatherData.dataPoints || 'N/A'}
                    </div>
                `;
                
                updateBackendStatus(true, 'Backend SurfAI connect√© et fonctionnel');
                updateAppStatus();
                
            } catch (error) {
                console.error('Erreur test backend:', error);
                resultDiv.innerHTML = `
                    <div class="error">
                        ‚ùå ${error.message}<br>
                        V√©rifiez que le backend est d√©marr√© sur le bon port.
                    </div>
                `;
                updateBackendStatus(false, `Erreur: ${error.message}`);
            }
        }

        // Appel API backend avec gestion d'erreurs
        async function backendRequest(endpoint, options = {}) {
            const url = `${backendUrl}${endpoint}`;
            const headers = {
                'Content-Type': 'application/json',
                ...options.headers
            };
            
            // Ajouter cl√© API si configur√©e
            if (backendApiKey && options.requireAuth) {
                headers['X-API-Key'] = backendApiKey;
            }
            
            const requestOptions = {
                ...options,
                headers
            };
            
            console.log(`üîó Appel backend: ${url}`);
            
            try {
                const response = await fetch(url, requestOptions);
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.message || `Erreur ${response.status}`);
                }
                
                return data;
            } catch (error) {
                console.error(`‚ùå Erreur appel backend ${endpoint}:`, error);
                throw error;
            }
        }

        // ========================================
        // PR√âVISIONS INTELLIGENTES
        // ========================================

        // R√©cup√©rer pr√©visions avec IA - VERSION CR√âNEAUX INTELLIGENTS
        async function getIntelligentForecast() {
            const spot = document.getElementById('forecast-spot').value;
            const level = document.getElementById('forecast-level').value;
            const days = document.getElementById('forecast-days').value;
            const forecastGrid = document.getElementById('forecast-grid');
            
            if (!spot) {
                showMessage('error', 'Veuillez s√©lectionner un spot');
                return;
            }
            
            forecastGrid.innerHTML = '<div class="loading">üß† Analyse cr√©neaux intelligents...</div>';
            
            try {
                // Coordonn√©es des spots
                const spotCoords = {
                    biarritz: { lat: 43.4832, lng: -1.5586 },
                    hossegor: { lat: 43.6619, lng: -1.4116 },
                    mimizan: { lat: 44.2138, lng: -1.2936 }
                };
                
                const coords = spotCoords[spot] || spotCoords.biarritz;
                
                // Appel API cr√©neaux intelligents
                const data = await backendRequest(
                    `/api/v1/weather/smart-slots?lat=${coords.lat}&lng=${coords.lng}&days=${days}&user_level=${level}&spot=${spot.charAt(0).toUpperCase() + spot.slice(1)}`
                );
                
                displayIntelligentSlots(data);
                
            } catch (error) {
                console.error('‚ùå Erreur cr√©neaux intelligents:', error);
                forecastGrid.innerHTML = `
                    <div class="error">
                        ‚ùå Erreur: ${error.message}<br>
                        V√©rifiez que le backend est accessible.
                    </div>
                `;
            }
        }

        // Afficher cr√©neaux intelligents
        function displayIntelligentSlots(data) {
            const forecastGrid = document.getElementById('forecast-grid');
            
            if (!data.optimalSlots || data.optimalSlots.length === 0) {
                forecastGrid.innerHTML = `
                    <div class="card">
                        <h4>ü§î Aucun cr√©neau optimal d√©tect√©</h4>
                        <p>Essayez d'augmenter le nombre de jours ou changez votre niveau.</p>
                        <p><strong>Spot:</strong> ${data.spot}</p>
                        <p><strong>Niveau:</strong> ${data.userLevel}</p>
                    </div>
                `;
                return;
            }
            
            // Afficher r√©sum√© de l'analyse
            const summaryHtml = `
                <div class="card" style="margin-bottom: 20px; background: linear-gradient(45deg, #f0fff4, #ffffff); border-left: 4px solid #48bb78;">
                    <h3>üß† Analyse Intelligente</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div><strong>üìç Spot:</strong> ${data.spot}</div>
                        <div><strong>üéØ Niveau:</strong> ${data.userLevel}</div>
                        <div><strong>üìä Cr√©neaux optimaux:</strong> ${data.totalSlots}</div>
                        <div><strong>üìÖ Jours analys√©s:</strong> ${data.meta.analyzedDays}</div>
                    </div>
                    <div style="margin-top: 15px; padding: 10px; background: #e6fffa; border-radius: 6px;">
                        <strong>üèÜ Meilleure session:</strong> ${data.analysis.bestSession.date} - ${data.analysis.bestSession.slot} √† ${data.analysis.bestSession.time} (${data.analysis.bestSession.score}/5)
                    </div>
                </div>
            `;
            
            // Afficher cr√©neaux par jour
            const slotsByDay = {};
            data.optimalSlots.forEach(slot => {
                if (!slotsByDay[slot.date]) {
                    slotsByDay[slot.date] = [];
                }
                slotsByDay[slot.date].push(slot);
            });
            
            let slotsHtml = summaryHtml;
            
            Object.keys(slotsByDay).forEach(date => {
                const daySlots = slotsByDay[date];
                const dayName = daySlots[0].dayName;
                
                slotsHtml += `
                    <div class="card" style="margin-bottom: 20px;">
                        <h3>üìÖ ${dayName}</h3>
                        <div class="forecast-grid">
                            ${daySlots.map(slot => createSlotCard(slot)).join('')}
                        </div>
                    </div>
                `;
            });
            
            // Afficher patterns d√©couverts
            if (data.analysis.patterns) {
                slotsHtml += `
                    <div class="card" style="background: linear-gradient(45deg, #fff5e6, #ffffff); border-left: 4px solid #ed8936;">
                        <h3>üìà Patterns d√©couverts</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div><strong>üïê Cr√©neau favori:</strong> ${data.analysis.patterns.mostFrequentSlot}</div>
                            <div><strong>‚≠ê Score moyen:</strong> ${data.analysis.patterns.avgScore}/5</div>
                            <div><strong>üìä Total jours:</strong> ${data.analysis.patterns.totalDays}</div>
                        </div>
                        <div style="margin-top: 10px; font-style: italic; color: #666;">
                            ${data.analysis.recommendation}
                        </div>
                    </div>
                `;
            }
            
            forecastGrid.innerHTML = slotsHtml;
        }
        
        // Cr√©er carte d'un cr√©neau
        function createSlotCard(slot) {
            const time = new Date(slot.optimalTime);
            const timeStr = time.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });
            const score = slot.scores.compositeScore;
            
            // D√©terminer style selon score
            let cardClass = 'forecast-card';
            let scoreClass = 'forecast-score';
            
            if (score >= 4) {
                cardClass += ' excellent';
                scoreClass += ' excellent';
            } else if (score >= 3.5) {
                cardClass += ' good';
                scoreClass += ' good';
            } else if (score >= 2.5) {
                cardClass += ' average';
                scoreClass += ' average';
            } else {
                scoreClass += ' poor';
            }
            
            return `
                <div class="${cardClass}" style="min-height: 280px;">
                    <div class="forecast-header">
                        <span class="forecast-date">${slot.slot.emoji} ${slot.slot.name} ${timeStr}</span>
                        <span class="${scoreClass}">${score.toFixed(1)}/5</span>
                    </div>
                    
                    <!-- Conditions principales -->
                    <div class="forecast-conditions">
                        <div class="condition">üåä ${slot.conditions.waveHeight}m</div>
                        <div class="condition">‚è±Ô∏è ${slot.conditions.wavePeriod || 'N/A'}s</div>
                        <div class="condition">üí® ${Math.round(slot.conditions.windSpeed)}km/h</div>
                        <div class="condition">üß≠ ${slot.conditions.windDirection}¬∞</div>
                        <div class="condition">üåä ${slot.tide.phase}</div>
                        <div class="condition">üìè ${slot.tide.height}m</div>
                        ${slot.conditions.offshore ? '<div class="condition" style="color: #48bb78;">üå¨Ô∏è Offshore</div>' : ''}
                    </div>
                    
                    <!-- Scores d√©taill√©s -->
                    <div style="margin: 10px 0; padding: 8px; background: #f8fafc; border-radius: 4px; font-size: 0.85rem;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 5px;">
                            <div>üìä Base: ${slot.scores.baseScore.toFixed(1)}</div>
                            <div>üéÅ Bonus: ${slot.scores.slotBonus.toFixed(1)}</div>
                            <div>üéØ Confiance: ${Math.round(slot.scores.confidence * 100)}%</div>
                            <div>üåä Mar√©e: ${slot.tide.coefficient}</div>
                        </div>
                    </div>
                    
                    <!-- Recommandation -->
                    <div class="prediction-info">
                        <div class="prediction-recommendation" style="font-size: 0.9rem;">
                            ${slot.recommendation}
                        </div>
                        <div style="margin-top: 5px; font-size: 0.8rem; color: #666;">
                            ${slot.slot.description}
                        </div>
                        ${slot.analysis.bonusReasons.length > 0 ? `
                            <div style="margin-top: 5px; font-size: 0.8rem; color: #48bb78;">
                                üí° ${slot.analysis.bonusReasons.join(', ')}
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        // G√©n√©rer pr√©dictions intelligentes pour le dashboard - VERSION CR√âNEAUX
        async function generateIntelligentRecommendations() {
            const recommendationsDiv = document.getElementById('recommendations');
            recommendationsDiv.innerHTML = '<div class="loading">üß† Analyse cr√©neaux intelligents...</div>';
            
            try {
                // Utiliser l'API cr√©neaux intelligents
                const data = await backendRequest('/api/v1/weather/smart-slots?lat=43.4832&lng=-1.5586&days=2&user_level=intermediate&spot=Biarritz');
                
                if (data.optimalSlots && data.optimalSlots.length > 0) {
                    const topSlots = data.optimalSlots.slice(0, 3); // Top 3 cr√©neaux
                    
                    const recommendations = topSlots.map((slot, index) => {
                        const time = new Date(slot.optimalTime);
                        const timeStr = time.toLocaleString('fr-FR', { 
                            weekday: 'short', 
                            day: 'numeric', 
                            month: 'short',
                            hour: '2-digit', 
                            minute: '2-digit' 
                        });
                        const score = slot.scores.compositeScore;
                        
                        let badgeColor = '#48bb78';
                        if (score >= 4) badgeColor = '#48bb78';
                        else if (score >= 3.5) badgeColor = '#4299e1';
                        else badgeColor = '#ed8936';
                        
                        return `
                            <div class="card" style="position: relative;">
                                <div style="position: absolute; top: 10px; right: 10px; background: ${badgeColor}; color: white; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem; font-weight: bold;">
                                    #${index + 1} ‚Ä¢ ${score.toFixed(1)}/5
                                </div>
                                <h4>${slot.slot.emoji} ${slot.slot.name} - ${timeStr}</h4>
                                <p><strong>${slot.recommendation}</strong></p>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 10px; margin-top: 10px; font-size: 0.9rem; color: #666;">
                                    <div>üåä ${slot.conditions.waveHeight}m</div>
                                    <div>üí® ${Math.round(slot.conditions.windSpeed)}km/h</div>
                                    <div>üåä ${slot.tide.phase}</div>
                                    <div>üìè ${slot.tide.height}m</div>
                                    ${slot.conditions.offshore ? '<div style="color: #48bb78;">üå¨Ô∏è Offshore</div>' : ''}
                                </div>
                                <div style="margin-top: 8px; font-size: 0.85rem; color: #666; font-style: italic;">
                                    ${slot.slot.description}
                                </div>
                            </div>
                        `;
                    }).join('');
                    
                    recommendationsDiv.innerHTML = `
                        <div style="margin-bottom: 15px; padding: 10px; background: linear-gradient(45deg, #e6fffa, #ffffff); border-radius: 8px; border-left: 4px solid #48bb78;">
                            <strong>üß† IA SurfAI a analys√© ${data.totalSlots} cr√©neaux sur ${data.meta.analyzedDays} jours</strong><br>
                            <span style="font-size: 0.9rem; color: #666;">Voici vos 3 meilleures opportunit√©s :</span>
                        </div>
                        ${recommendations}
                        <div style="margin-top: 15px; padding: 10px; background: #f8fafc; border-radius: 6px; font-size: 0.9rem; color: #666;">
                            üí° <strong>Pattern d√©tect√© :</strong> Cr√©neau optimal : ${data.analysis.patterns.mostFrequentSlot} ‚Ä¢ Score moyen : ${data.analysis.patterns.avgScore}/5
                        </div>
                    `;
                } else {
                    recommendationsDiv.innerHTML = `
                        <div class="card">
                            <h4>ü§î L'IA n'a pas trouv√© de cr√©neaux exceptionnels</h4>
                            <p>Conditions analys√©es pour les prochains jours :</p>
                            <ul style="margin-left: 20px;">
                                <li>üìç Spot : ${data.spot}</li>
                                <li>üéØ Niveau : ${data.userLevel}</li>
                                <li>üìä Cr√©neaux analys√©s : ${data.totalSlots}</li>
                            </ul>
                            <p style="margin-top: 10px;">Consultez l'onglet M√©t√©o pour plus de d√©tails !</p>
                        </div>
                    `;
                }
                
            } catch (error) {
                console.error('‚ùå Erreur recommandations intelligentes:', error);
                recommendationsDiv.innerHTML = `
                    <div class="error">
                        ‚ùå Erreur analyse intelligente: ${error.message}<br>
                        V√©rifiez que le backend est accessible.
                    </div>
                `;
            }
        }

        // G√©n√©rer pr√©dictions pour l'onglet pr√©dictions - VERSION CR√âNEAUX
        async function generateIntelligentPredictions() {
            const level = document.getElementById('prediction-level').value;
            const days = document.getElementById('prediction-days').value;
            const predictionsDiv = document.getElementById('predictions-list');
            
            predictionsDiv.innerHTML = '<div class="loading">üß† Analyse cr√©neaux intelligents...</div>';
            
            try {
                const data = await backendRequest(`/api/v1/weather/smart-slots?lat=43.4832&lng=-1.5586&days=${days}&user_level=${level}&spot=Biarritz`);
                
                if (data.optimalSlots && data.optimalSlots.length > 0) {
                    // Grouper par jour pour un affichage plus clair
                    const slotsByDay = {};
                    data.optimalSlots.forEach(slot => {
                        if (!slotsByDay[slot.date]) {
                            slotsByDay[slot.date] = [];
                        }
                        slotsByDay[slot.date].push(slot);
                    });
                    
                    let predictionsHtml = `
                        <div class="card" style="margin-bottom: 20px; background: linear-gradient(45deg, #f0fff4, #ffffff); border-left: 4px solid #48bb78;">
                            <h4>üß† Analyse Intelligente Compl√®te</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 15px;">
                                <div><strong>üìç Spot:</strong> ${data.spot}</div>
                                <div><strong>üéØ Niveau:</strong> ${data.userLevel}</div>
                                <div><strong>üìä Cr√©neaux analys√©s:</strong> ${data.totalSlots}</div>
                                <div><strong>üìÖ Jours:</strong> ${data.meta.analyzedDays}</div>
                            </div>
                            <div style="padding: 10px; background: #e6fffa; border-radius: 6px;">
                                <strong>üèÜ Meilleure session pr√©vue:</strong><br>
                                ${data.analysis.bestSession.date} - ${data.analysis.bestSession.slot} √† ${data.analysis.bestSession.time}<br>
                                <span style="color: #48bb78; font-weight: bold;">Score: ${data.analysis.bestSession.score}/5</span>
                            </div>
                        </div>
                    `;
                    
                    // Afficher cr√©neaux par jour
                    Object.keys(slotsByDay).forEach(date => {
                        const daySlots = slotsByDay[date];
                        const dayName = daySlots[0].dayName;
                        
                        predictionsHtml += `
                            <div class="card" style="margin-bottom: 15px;">
                                <h4>üìÖ ${dayName}</h4>
                                <div class="forecast-grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));">
                                    ${daySlots.map(slot => createSlotCard(slot)).join('')}
                                </div>
                            </div>
                        `;
                    });
                    
                    // Ajouter analyse des patterns
                    if (data.analysis.patterns) {
                        predictionsHtml += `
                            <div class="card" style="background: linear-gradient(45deg, #fff5e6, #ffffff); border-left: 4px solid #ed8936;">
                                <h4>üìà Insights & Patterns</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                    <div><strong>üïê Cr√©neau optimal:</strong> ${data.analysis.patterns.mostFrequentSlot}</div>
                                    <div><strong>‚≠ê Score moyen:</strong> ${data.analysis.patterns.avgScore}/5</div>
                                    <div><strong>üìä Jours analys√©s:</strong> ${data.analysis.patterns.totalDays}</div>
                                </div>
                                <div style="margin-top: 10px; padding: 8px; background: #fff0e6; border-radius: 4px; font-style: italic;">
                                    <strong>üí° Recommandation globale:</strong> ${data.analysis.recommendation}
                                </div>
                            </div>
                        `;
                    }
                    
                    predictionsDiv.innerHTML = predictionsHtml;
                } else {
                    predictionsDiv.innerHTML = `
                        <div class="card">
                            <h4>ü§î Aucun cr√©neau optimal pour votre niveau</h4>
                            <p><strong>Param√®tres d'analyse :</strong></p>
                            <ul style="margin-left: 20px;">
                                <li>üìç Spot : ${data.spot}</li>
                                <li>üéØ Niveau : ${data.userLevel}</li>
                                <li>üìä Cr√©neaux analys√©s : ${data.totalSlots}</li>
                                <li>üìÖ P√©riode : ${days} jours</li>
                            </ul>
                            <p style="margin-top: 15px;"><strong>üí° Conseils :</strong></p>
                            <ul style="margin-left: 20px;">
                                <li>Essayez d'augmenter le nombre de jours</li>
                                <li>Changez votre niveau si vous √™tes plus/moins exp√©riment√©</li>
                                <li>Consultez les pr√©visions d√©taill√©es dans l'onglet M√©t√©o</li>
                            </ul>
                        </div>
                    `;
                }
                
            } catch (error) {
                console.error('‚ùå Erreur pr√©dictions cr√©neaux:', error);
                predictionsDiv.innerHTML = `
                    <div class="error">
                        ‚ùå Erreur analyse cr√©neaux: ${error.message}
                    </div>
                `;
            }
        }

        // ========================================
        // FONCTIONS NAVIGATION ET UTILITAIRES
        // ========================================

        // Navigation entre onglets
        function showTab(tabName) {
            // Masquer tous les onglets
            document.querySelectorAll('.tab-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Afficher l'onglet s√©lectionn√©
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Charger les donn√©es si n√©cessaire
            if (tabName === 'sessions') loadSessions();
            if (tabName === 'spots') loadSpots();
            if (tabName === 'profile') loadProfile();
            if (tabName === 'predictions') generateIntelligentPredictions();
        }

        // Fonctions Supabase (gard√©es pour compatibilit√©)
        async function testSupabaseConnection() {
            const url = document.getElementById('supabase-url').value;
            const key = document.getElementById('supabase-key').value;
            
            if (!url || !key) {
                showMessage('error', 'Veuillez renseigner URL et cl√© Supabase');
                return;
            }
            
            try {
                supabaseClient = supabase.createClient(url, key, {
                    auth: {
                        persistSession: false,
                        autoRefreshToken: false
                    }
                });
                
                const { data, error } = await supabaseClient
                    .from('spots')
                    .select('id, name')
                    .limit(1);
                
                if (error) {
                    throw new Error(`Erreur Supabase: ${error.message}`);
                }
                
                showMessage('success', `‚úÖ Connexion Supabase r√©ussie ! ${data?.length || 0} spots trouv√©s`);
                
                localStorage.setItem('supabase_url', url);
                localStorage.setItem('supabase_key', key);
                
                updateAppStatus();
                await loadRealData();
                
            } catch (error) {
                console.error('Erreur Supabase:', error);
                showMessage('error', `‚ùå ${error.message}`);
            }
        }

        // Fonctions de donn√©es (simplifi√©es pour la demo)
        function loadSessions() {
            // Impl√©mentation simplifi√©e
            const sessionsList = document.getElementById('sessions-list');
            sessionsList.innerHTML = `
                <div class="card">
                    <p>üèÑ‚Äç‚ôÇÔ∏è Connectez Supabase pour voir vos sessions r√©elles.</p>
                    <p>Le backend SurfAI est pr√™t √† traiter vos donn√©es !</p>
                </div>
            `;
        }

        function loadSpots() {
            // Donn√©es simul√©es des spots
            const favoritesList = document.getElementById('favorite-spots-list');
            const allSpotsList = document.getElementById('all-spots-list');
            
            favoritesList.innerHTML = `
                <div class="card">
                    <h4>‚≠ê Biarritz</h4>
                    <p>üìç Pays Basque - Spot principal</p>
                    <p style="font-size: 0.9rem; color: #666;">üññ Beach break ‚Ä¢ üí® Vent: N, NE</p>
                </div>
            `;
            
            allSpotsList.innerHTML = `
                <div class="card">
                    <h4>üèÑ‚Äç‚ôÇÔ∏è Biarritz</h4>
                    <p>üìç Pays Basque</p>
                    <p style="font-size: 0.9rem; color: #666;">üññ Beach break ‚Ä¢ üí® Vent optimal: N, NE</p>
                    <span style="color: #48bb78;">‚úÖ Dans vos favoris</span>
                </div>
                <div class="card">
                    <h4>üìç Hossegor</h4>
                    <p>üìç Nouvelle-Aquitaine</p>
                    <p style="font-size: 0.9rem; color: #666;">üññ Beach break ‚Ä¢ üí® Vent optimal: E, SE</p>
                    <button class="button">Ajouter aux favoris</button>
                </div>
            `;
        }

        function loadProfile() {
            // Impl√©mentation simplifi√©e
            const boardsList = document.getElementById('user-boards-list');
            boardsList.innerHTML = `
                <div class="card">
                    <p>üèÑ‚Äç‚ôÇÔ∏è Connectez Supabase pour g√©rer vos boards r√©elles.</p>
                    <p>Ajoutez vos boards ci-dessus pour commencer !</p>
                </div>
            `;
        }

        async function loadRealData() {
            // Impl√©mentation Supabase compl√®te √† adapter selon vos besoins
            console.log('üìÑ Chargement donn√©es r√©elles...');
        }

        function analyzePatterns() {
            const patternsDiv = document.getElementById('patterns');
            patternsDiv.innerHTML = '<div class="loading">üß† Analyse de vos patterns...</div>';
            
            setTimeout(() => {
                patternsDiv.innerHTML = `
                    <div class="success">
                        <h4>üéØ Vos patterns d√©tect√©s :</h4>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>üåä Conditions optimales: vagues 1.2-1.8m</li>
                            <li>üí® Vent pr√©f√©r√©: 10-15 km/h offshore</li>
                            <li>üìç Spot favori: Biarritz</li>
                            <li>‚è∞ Horaire pr√©f√©r√©: 8h-10h et 17h-19h</li>
                        </ul>
                        <p style="margin-top: 15px;">
                            <strong>üí° L'IA recommande:</strong> 
                            Surveillez les sessions avec vent NE l√©ger et houle de 1.5m pour vos meilleures performances !
                        </p>
                    </div>
                `;
            }, 2000);
        }

        // Fonctions utilitaires
        function showMessage(type, message) {
            const messageDiv = document.createElement('div');
            messageDiv.className = type;
            messageDiv.innerHTML = message;
            
            const activeTab = document.querySelector('.tab-panel.active');
            activeTab.insertBefore(messageDiv, activeTab.firstChild);
            
            setTimeout(() => messageDiv.remove(), 3000);
        }

        function updateAppStatus() {
            const statusDiv = document.getElementById('app-status');
            statusDiv.innerHTML = `
                <p>üü¢ Backend: Connect√© et fonctionnel</p>
                <p>${supabaseClient ? 'üü¢' : 'üî¥'} Supabase: ${supabaseClient ? 'Configur√©' : 'Non configur√©'}</p>
                <p>üü¢ Donn√©es: Pr√™tes pour l'IA</p>
            `;
        }

        // Mettre √† jour les statistiques du dashboard
        function updateDashboard() {
            document.getElementById('total-sessions').textContent = userData.sessions.length;
            document.getElementById('avg-rating').textContent = userData.sessions.length > 0 ? 
                (userData.sessions.reduce((sum, s) => sum + s.rating, 0) / userData.sessions.length).toFixed(1) : '-';
            document.getElementById('favorite-spots').textContent = userData.favoriteSpots.length;
        }
    </script>
</body>
</html>
